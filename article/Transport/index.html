<!-- build time:Sun Dec 21 2025 16:41:25 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" href="http://amentiraz.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" href="http://amentiraz.github.io/atom.xml"><link rel="alternate" type="application/json" href="http://amentiraz.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="ç®—æ³•,ç”Ÿç‰©,å­¦ä¹ ç¬”è®°ç±»"><link rel="canonical" href="http://amentiraz.github.io/article/Transport/"><title>Optimal Transport - è®ºæ–‡ | Amentiraz =</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Optimal Transport</h1><div class="meta"><span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2025-10-24 09:21:55"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">å‘è¡¨äº</span> <time itemprop="dateCreated datePublished" datetime="2025-10-24T09:21:55+08:00">2025-10-24</time> </span><span class="item" title="æœ¬æ–‡å­—æ•°"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">æœ¬æ–‡å­—æ•°</span> <span>9.7k</span> <span class="text">å­—</span> </span><span class="item" title="é˜…è¯»æ—¶é•¿"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">é˜…è¯»æ—¶é•¿</span> <span>9 åˆ†é’Ÿ</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Amentiraz</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://amentirazblogpic.oss-cn-hangzhou.aliyuncs.com/blogpic/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240925124451.jpg"></li><li class="item" data-background-image="https://amentirazblogpic.oss-cn-hangzhou.aliyuncs.com/blogpic/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240925124317.png"></li><li class="item" data-background-image="https://amentirazblogpic.oss-cn-hangzhou.aliyuncs.com/blogpic/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240925124403.png"></li><li class="item" data-background-image="https://amentirazblogpic.oss-cn-hangzhou.aliyuncs.com/blogpic/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240925162718.png"></li><li class="item" data-background-image="https://amentirazblogpic.oss-cn-hangzhou.aliyuncs.com/blogpic/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240925162829.png"></li><li class="item" data-background-image="https://amentirazblogpic.oss-cn-hangzhou.aliyuncs.com/blogpic/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240925124522.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/article/" itemprop="item" rel="index" title="åˆ†ç±»äº è®ºæ–‡"><span itemprop="name">è®ºæ–‡</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://amentiraz.github.io/article/Transport/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Lemon Sour"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content=""></span><div class="body md" itemprop="articleBody"><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"># æœ€ä¼˜ä¼ è¾“</span><br><span class="line"></span><br><span class="line">å¦‚ä½•ç”¨æœ€å°‘çš„ä»£ä»·å°†ä¸€ä¸ªè´¨é‡åˆ†å¸ƒè½¬ä¸ºå¦ä¸€ä¸ªè´¨é‡åˆ†å¸ƒ</span><br><span class="line"></span><br><span class="line">## Monge</span><br><span class="line"></span><br><span class="line">Let Î¼ and Î½ be two measures in $\mathbb&#123;R&#125;^d$. The optimal transport problem by Monge is defined as</span><br><span class="line"></span><br><span class="line">$$\begin&#123;equation&#125;</span><br><span class="line">&#123;\arg \min &#125;_&#123;T:&#123;T&#125;_&#123;\sharp &#125;\mu = \nu &#125;\,\,&#123;&#123;\mathbb&#123;E&#125;&#125;&#125;_&#123;X \sim \mu &#125;\parallel X-T(X)&#123;\parallel &#125;_&#123;2&#125;^&#123;2&#125;,</span><br><span class="line">\end&#123;equation&#125;$$</span><br><span class="line"></span><br><span class="line">where $T$ corresponding to the smallest cost is the optimal transport map.</span><br><span class="line"></span><br><span class="line">$&#123;T&#125;_&#123;\sharp &#125;$æ˜¯å‰æ¨ç®—å­ï¼Œè®©$&#123;T&#125;_&#123;\sharp &#125;$çš„ä½œç”¨å¯¹è±¡æ˜¯$\mu$,è¡¨ç¤ºå§$\mu$æ¨åˆ°$v$</span><br><span class="line"></span><br><span class="line">é€šä¿—åœ°è¯´ï¼Œä¿æµ‹åº¦çš„æ„æ€å°±æ˜¯ä½ ä»$X$æ¬å¤šå°‘é‡é‡çš„ä¸œè¥¿ï¼ˆåœ¨$Y$çš„åº¦é‡ä¸‹ï¼‰ åˆ°$X$çš„æŸä¸ªåŒºåŸŸï¼Œè¿™ä¸ªåŒºåŸŸåœ¨$Y$çš„åº¦é‡ä¸‹ä¹Ÿå¾—æœ‰è¿™ä¹ˆå¤šé‡é‡ã€‚</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯æ˜ å°„çš„å®šä¹‰é™åˆ¶äº†ä¸èƒ½å®ç°ä¸€å¯¹å¤šçš„æ“ä½œï¼Œä»¥è‡³äºMongeé—®é¢˜ä¸ä¸€å®šæœ‰è§£ã€‚</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬å¯ä»¥è®©è´¨é‡â€œå¯åˆ†â€ï¼Œå³ä»¥æ¦‚ç‡çš„å½¢å¼å»è¿›è¡Œâ€œç§»åŠ¨â€ã€‚è¿™å°±æ˜¯Kantoroviché—®é¢˜ã€‚</span><br><span class="line"></span><br><span class="line">## kantorovich</span><br><span class="line"></span><br><span class="line">$$\begin&#123;equation&#125;</span><br><span class="line">W(\mu ,\nu )=\mathop&#123;\min &#125;\limits_&#123;\gamma \in &#123;&#123;\Gamma &#125;&#125;(\mu ,\nu )&#125;&#123;&#123;\mathbb&#123;E&#125;&#125;&#125;_&#123;(X,Y) \sim \gamma &#125;\parallel X-Y&#123;\parallel &#125;_&#123;2&#125;^&#123;2&#125;,</span><br><span class="line">\end&#123;equation&#125;$$</span><br><span class="line"></span><br><span class="line">where the polytope Î“(Î¼,â€‰Î½) is $\&#123;\gamma \in &#123;&#123;\mathbb&#123;R&#125;&#125;&#125;_&#123;+&#125;^&#123;n\times m&#125;,\gamma &#123;&#123;&#123;&#123;\bf&#123;1&#125;&#125;&#125;&#125;&#125;_&#123;m&#125;=\mu ,&#123;\gamma &#125;^&#123;\top &#125;&#123;&#123;&#123;&#123;\bf&#123;1&#125;&#125;&#125;&#125;&#125;_&#123;n&#125;=\nu \&#125;$</span><br><span class="line">, describes the set of all couplings (or joint distributions) Î³ between Î¼ and Î½.</span><br></pre></td></tr></table></figure><p><img data-src="https://amentirazblogpic.oss-cn-hangzhou.aliyuncs.com/blog/Kantorovich%20Relaxation.png" alt=""></p><h2 id="wasserstein"><a class="anchor" href="#wasserstein">#</a> Wasserstein</h2><p><img data-src="https://amentirazblogpic.oss-cn-hangzhou.aliyuncs.com/blog/Wasserstein%20Distance.png" alt=""></p><h2 id="kantorovichå¯¹å¶"><a class="anchor" href="#kantorovichå¯¹å¶">#</a> Kantorovich å¯¹å¶</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">Problem (2) denotes the primal formulation of optimal transport. Kantorovich also introduces its corresponding dual54, which is a constrained concave maximization problem defined as</span><br><span class="line">$$\begin&#123;equation&#125;</span><br><span class="line">W(\mu ,\nu )=\mathop&#123;\max &#125;\limits_&#123;(g,f)\in &#123;&#123;&#123;\Phi &#125;&#125;&#125;_&#123;c&#125;&#125;&#123;&#123;\mathbb&#123;E&#125;&#125;&#125;_&#123;\mu &#125;[g(x)]+&#123;&#123;\mathbb&#123;E&#125;&#125;&#125;_&#123;\nu &#125;[f(y)],</span><br><span class="line">\end&#123;equation&#125;$$</span><br><span class="line"></span><br><span class="line">where the set of admissible potentials is$&#123;&#123;&#123;\Phi &#125;&#125;&#125;_&#123;c&#125;:=\left\&#123;(g,f)\in &#123;L&#125;^&#123;1&#125;(\mu )\times &#123;L&#125;^&#123;1&#125;(\nu ):g(x)+f(y)\le \frac&#123;1&#125;&#123;2&#125;\parallel x-y&#123;\parallel &#125;_&#123;2&#125;^&#123;2&#125;,\forall (x,y)d\mu \otimes d\nu \, &#123;&#123;&#123;\rm&#123;a.e.&#125;&#125;&#125;&#125;\right\&#125;$</span><br><span class="line"></span><br><span class="line">è¿™ä¸ªè®ºæ–‡é‡Œé¢ç»™å‡ºæ¥çš„å¯¹å¶å½¢å¼å®Œå…¨çœ‹ä¸æ‡‚</span><br><span class="line"></span><br><span class="line">é¦–å…ˆæˆ‘æŠŠæˆ‘æ²¡ææ‡‚çš„å‡ ä¸ªé—®é¢˜æ•´åˆä¸€ä¸‹</span><br><span class="line"></span><br><span class="line">### ç¬¬ä¸€ï¼š</span><br><span class="line"></span><br><span class="line">$$\begin&#123;equation&#125;</span><br><span class="line">W(\mu ,\nu )=\mathop&#123;\min &#125;\limits_&#123;\gamma \in &#123;&#123;\Gamma &#125;&#125;(\mu ,\nu )&#125;&#123;&#123;\mathbb&#123;E&#125;&#125;&#125;_&#123;(X,Y) \sim \gamma &#125;\parallel X-Y&#123;\parallel &#125;_&#123;2&#125;^&#123;2&#125;,</span><br><span class="line">\end&#123;equation&#125;$$</span><br><span class="line"></span><br><span class="line">å’Œ$1/2(||x-y||^2_2)$æœ‰ä»€ä¹ˆå…³è”:</span><br><span class="line">å†™çš„å…¬å¼æ˜¯</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">W(\mu ,\nu )=\min_&#123;\gamma \in \Gamma(\mu ,\nu )&#125;\,\mathbb&#123;E&#125;_&#123;(X,Y)\sim \gamma&#125;\, \|X-Y\|_2^&#123;2&#125;,</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">è€Œåœ¨å¯¹å¶å½¢å¼é‡Œï¼Œçº¦æŸæ¡ä»¶å˜æˆ</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">f(x)+g(y) \le \tfrac&#123;1&#125;&#123;2&#125;\|x-y\|_2^2.</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">ä½ æƒ³çŸ¥é“ä¸ºä»€ä¹ˆè¿™é‡Œçªç„¶å†’å‡ºäº†ä¸€ä¸ª **$ \tfrac&#123;1&#125;&#123;2&#125;$**ã€‚</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">#### å…³é”®ç‚¹ï¼šä»£ä»·å‡½æ•°çš„é€‰æ‹©</span><br><span class="line"></span><br><span class="line">åœ¨æœ€ä¼˜ä¼ è¾“ï¼ˆOTï¼‰é‡Œï¼Œä»£ä»·å‡½æ•° $c(x,y)$ æ˜¯ **ä½ è‡ªå·±å®šä¹‰çš„**ã€‚</span><br><span class="line"></span><br><span class="line">* å¦‚æœ primal é‡Œç”¨çš„æ˜¯</span><br><span class="line"></span><br><span class="line">  $$</span><br><span class="line">  c(x,y) = \|x-y\|_2^2,</span><br><span class="line">  $$</span><br><span class="line"></span><br><span class="line">  é‚£ä¹ˆ dual å°±ä¼šå‡ºç°</span><br><span class="line"></span><br><span class="line">  $$</span><br><span class="line">  f(x)+g(y) \le \|x-y\|_2^2.</span><br><span class="line">  $$</span><br><span class="line"></span><br><span class="line">* å¦‚æœ primal é‡Œç”¨çš„æ˜¯</span><br><span class="line"></span><br><span class="line">  $$</span><br><span class="line">  c(x,y) = \tfrac&#123;1&#125;&#123;2&#125;\|x-y\|_2^2,</span><br><span class="line">  $$</span><br><span class="line"></span><br><span class="line">  é‚£ä¹ˆ dual å°±ä¼šå‡ºç°</span><br><span class="line"></span><br><span class="line">  $$</span><br><span class="line">  f(x)+g(y) \le \tfrac&#123;1&#125;&#123;2&#125;\|x-y\|_2^2.</span><br><span class="line">  $$</span><br><span class="line"></span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´ï¼Œ**é‚£ä¸ª $\tfrac&#123;1&#125;&#123;2&#125;$ å¹¶ä¸æ˜¯æ¨å¯¼å‡ºæ¥çš„ï¼Œè€Œæ˜¯ä½œè€…ä¸€å¼€å§‹å°±é€‰æ‹©äº†å¸¦ $\tfrac&#123;1&#125;&#123;2&#125;$ çš„ä»£ä»·å‡½æ•°**ã€‚</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">#### ä¸ºä»€ä¹ˆå¾ˆå¤šæ–‡çŒ®å–œæ¬¢ç”¨ $\tfrac&#123;1&#125;&#123;2&#125;\|x-y\|^2$ï¼Ÿ</span><br><span class="line"></span><br><span class="line">å› ä¸ºè¿™æ ·åœ¨æ¨å¯¼ **Brenier å®šç†**ï¼ˆå‡¸åŠ¿å‡½æ•°çš„æ¢¯åº¦ç»™å‡ºæœ€ä¼˜ä¼ è¾“æ˜ å°„ï¼‰æ—¶ï¼Œå½¢å¼æ›´æ¼‚äº®ï¼š</span><br><span class="line"></span><br><span class="line">* è‹¥ä»£ä»·æ˜¯ $\tfrac&#123;1&#125;&#123;2&#125;\|x-y\|^2$ï¼Œæœ€ä¼˜ä¼ è¾“å¯ä»¥å†™æˆ</span><br><span class="line"></span><br><span class="line">  $$</span><br><span class="line">  T(x) = x - \nabla f(x),</span><br><span class="line">  $$</span><br><span class="line"></span><br><span class="line">  å…¶ä¸­ $f$ æ˜¯ä¸ªå‡¸å‡½æ•°ã€‚</span><br><span class="line">* å¦‚æœæ²¡æœ‰è¿™ä¸ª $\tfrac&#123;1&#125;&#123;2&#125;$ï¼Œå°±ä¼šå¤šä¸€ä¸ª â€œ2â€ çš„å› å­ï¼Œè®©å…¬å¼çœ‹èµ·æ¥æ¯”è¾ƒä¸‘ã€‚</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥è¿™ä¸ª $\tfrac&#123;1&#125;&#123;2&#125;$ ä¸»è¦æ˜¯**è§„èŒƒåŒ–ï¼ˆconventionï¼‰**ï¼Œä¸å½±å“æœ€ä¼˜ä¼ è¾“çš„æœ¬è´¨ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### ç¬¬äºŒä¸ªï¼Œç›´è§‚çš„ç†è§£ä¸€ä¸‹å¯¹å¶é—®é¢˜ï¼š</span><br></pre></td></tr></table></figure><p><img data-src="https://amentirazblogpic.oss-cn-hangzhou.aliyuncs.com/blog/Dual%20problem.png" alt=""></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><span class="line">### ç¬¬ä¸‰ä¸ªï¼Œæ€ä¹ˆåˆ©ç”¨æ‹‰æ ¼æœ—æ—¥å¯¹å¶å½¢å¼</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 2. æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€è·¯ (Lagrangian Duality)</span><br><span class="line"></span><br><span class="line">ä¸ºä»€ä¹ˆä¼šå‡ºç°å¯¹å¶å½¢å¼ï¼ˆå¸¦ $g(x)+f(y) \le c(x,y)$ çš„å…¬å¼ï¼‰å‘¢ï¼Ÿè¿™æ˜¯ **æ‹‰æ ¼æœ—æ—¥å¯¹å¶**çš„å…¸å‹åº”ç”¨ã€‚æ€è·¯åˆ†å‡ æ­¥ï¼š</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">###### (1) åŸå§‹é—®é¢˜ (Primal)</span><br><span class="line"></span><br><span class="line">å†™æˆç§¯åˆ†å½¢å¼ï¼š</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">\min_&#123;\gamma \ge 0&#125; \int c(x,y)\, d\gamma(x,y)</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">çº¦æŸï¼š</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">\int d\gamma(x,y) = \mu(x), \quad \int d\gamma(x,y) = \nu(y).</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´ï¼š</span><br><span class="line"></span><br><span class="line">* $\gamma$ çš„ $x$-è¾¹é™…æ˜¯ $\mu$ï¼›</span><br><span class="line">* $\gamma$ çš„ $y$-è¾¹é™…æ˜¯ $\nu$ã€‚</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">###### (2) ç»™çº¦æŸåŠ æ‹‰æ ¼æœ—æ—¥ä¹˜å­</span><br><span class="line"></span><br><span class="line">ç”¨å‡½æ•° $g(x)$ã€$f(y)$ ä½œä¸ºæ‹‰æ ¼æœ—æ—¥ä¹˜å­ï¼Œå†™æˆæ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">L(\gamma, g,f) = \int c(x,y)\, d\gamma(x,y) </span><br><span class="line">+ \int g(x)\, \big( d\mu(x) - \int d\gamma(x,y)\big) </span><br><span class="line">+ \int f(y)\, \big( d\nu(y) - \int d\gamma(x,y)\big).</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">å±•å¼€åå¾—åˆ°ï¼š</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">L(\gamma,g,f) = \int g(x)\, d\mu(x) + \int f(y)\, d\nu(y) + \int \big(c(x,y) - g(x) - f(y)\big)\, d\gamma(x,y).</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">###### (3) å– inf over $\gamma$</span><br><span class="line"></span><br><span class="line">* æˆ‘ä»¬å¸Œæœ› $\min_\gamma L(\gamma,g,f)$ æ˜¯è‰¯å®šä¹‰çš„ã€‚</span><br><span class="line">* å¦‚æœ $c(x,y) - g(x) - f(y) &lt; 0$ åœ¨æŸå¤„æˆç«‹ï¼Œé‚£ä¹ˆå¯¹é‚£ä¸ªåœ°æ–¹çš„ $\gamma(x,y)$ å¯ä»¥è¶‹å‘æ— ç©·å¤§ï¼Œå°±ä¼šè®© $L$ è¶‹å‘ $-\infty$ã€‚</span><br><span class="line">* ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œå¿…é¡»è¦æ±‚</span><br><span class="line"></span><br><span class="line">  $$</span><br><span class="line">  g(x) + f(y) \le c(x,y), \quad \forall (x,y).</span><br><span class="line">  $$</span><br><span class="line"></span><br><span class="line">  è¿™å°±æ˜¯ä½ çœ‹åˆ°çš„æ¡ä»¶ã€‚</span><br><span class="line"></span><br><span class="line">äºæ˜¯ $\inf_\gamma L(\gamma,g,f) = \int g\, d\mu + \int f\, d\nu$ï¼Œå¦‚æœæ»¡è¶³çº¦æŸï¼Œå¦åˆ™æ˜¯ $-\infty$ã€‚</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">###### (4) å¾—åˆ°å¯¹å¶é—®é¢˜ (Dual)</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥å¯¹å¶é—®é¢˜å°±æ˜¯ï¼š</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">\sup_&#123;g,f&#125; \;\; \int g(x)\, d\mu(x) + \int f(y)\, d\nu(y) \quad </span><br><span class="line">\text&#123;s.t.&#125;\quad g(x)+f(y)\le c(x,y).</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">è¿™å°±æ˜¯ **Kantorovich å¯¹å¶å½¢å¼**ã€‚</span><br><span class="line"></span><br><span class="line">## Villaniå¯¹äºè¿™ä¸ªdualé—®é¢˜çš„è½¬åŒ–</span><br><span class="line"></span><br><span class="line">$$\begin&#123;equation&#125;</span><br><span class="line">W(\mu, \nu)= \underbrace&#123;\frac&#123;1&#125;&#123;2&#125;&#123;\mathbb&#123;E&#125;&#125;\left[\|x\|_&#123;2&#125;^&#123;2&#125;+\|y\|_&#123;2&#125;^&#123;2&#125;\right]&#125;_&#123;&#123;\mathcal&#123;C&#125;&#125;_&#123;\mu, \nu&#125;&#125;-\min _&#123;f \in &#123;\tilde&#123;\mathrm&#123;\Phi&#125;&#125;&#125;&#125; &#123;\mathbb&#123;E&#125;&#125;_&#123;\mu&#125;[f^&#123;*&#125;(x)]+&#123;\mathbb&#123;E&#125;&#125;_&#123;\nu&#125;\left[f(y)\right],</span><br><span class="line">\end&#123;equation&#125;$$</span><br><span class="line">where </span><br><span class="line">$\widetilde&#123;&#123;&#123;\Phi &#125;&#125;&#125;$ is the set of all convex functions in $L1(dÎ¼)â€‰Ã—â€‰L1(dÎ½)$, L1(Î¼):=&#123;g is measurable &amp; âˆ«gdÎ¼â€‰&lt;â€‰âˆ&#125; , $&#123;f&#125;^&#123;* &#125;(x)=\mathop&#123;\max &#125;\nolimits_&#123;y&#125;\langle y,x\rangle -f(y)$ is fâ€™s convex conjugate, and the optimal transport map transforming Î¼ into Î½ corresponds to the gradient of $f*$, i.e., $Tâ€‰=â€‰âˆ‡â€‰f*$. We can recover the optimal transport plan via $\gamma =&#123;(\nabla &#123;f&#125;^&#123;* &#125;\times &#123;&#123;&#123;\rm&#123;Id&#125;&#125;&#125;&#125;)&#125;_&#123;\sharp &#125;\mu$</span><br><span class="line">. Theorem 2.9 by Villani23 then proves the existence of an optimal pair $(f,â€‰f*)$ of lower semi-continuous proper conjugate convex functions on $\mathbb&#123;R&#125;^n$</span><br><span class="line"> minimizing (3).</span><br><span class="line"></span><br><span class="line">è¿™ä¸€å¤§æ®µæˆ‘å°±çœ‹ä¸æ‡‚äº†ï¼Œæˆ‘ä¹Ÿä¸æƒ³çœ‹æ‡‚äº†ã€‚</span><br><span class="line"></span><br><span class="line">ä½†è¿˜æ˜¯é¡ºä¾¿ç†è§£ä¸€ä¸‹å‡¸å…±è½­</span><br><span class="line"></span><br><span class="line">###  å‡¸å…±è½­</span><br><span class="line"></span><br><span class="line">å¥½é—®é¢˜ ğŸ‘ã€‚**å‡¸å…±è½­ (convex conjugate)** æ˜¯å‡¸åˆ†æé‡Œçš„ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œç›´è§‰ä¸Šå®ƒæè¿°äº†ä¸€ä¸ªå‡½æ•°åœ¨æ‰€æœ‰å¯èƒ½â€œæ–œç‡â€ä¸‹çš„â€œæœ€ä½³çº¿æ€§è¿‘ä¼¼â€ã€‚æˆ‘å¸®ä½ æ‹†å¼€ï¼š</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">1.å®šä¹‰</span><br><span class="line"></span><br><span class="line">ç»™å®šä¸€ä¸ªå‡½æ•° $f:\mathbb&#123;R&#125;^d \to \mathbb&#123;R&#125;\cup\&#123;+\infty\&#125;$ï¼Œå®ƒçš„ **å‡¸å…±è½­** $f^*$ å®šä¹‰ä¸ºï¼š</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">f^*(x) = \sup_&#123;y \in \mathbb&#123;R&#125;^d&#125; \&#123;\langle x, y \rangle - f(y)\&#125;.</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">* $\langle x, y\rangle$ æ˜¯ä¸€ä¸ªçº¿æ€§å‡½æ•°ï¼ˆæ–œç‡ç”± $x$ å†³å®šï¼‰ã€‚</span><br><span class="line">* $\langle x, y\rangle - f(y)$ è¡¨ç¤ºâ€œçº¿æ€§å‡½æ•° $\langle x, y\rangle$â€å‡å»åŸå‡½æ•°çš„å€¼ã€‚</span><br><span class="line">* å¯¹æ‰€æœ‰ $y$ å–æœ€å¤§å€¼ï¼Œå¾—åˆ°çš„å°±æ˜¯ $f^*(x)$ã€‚</span><br><span class="line"></span><br><span class="line">ğŸ‘‰ æ¢å¥è¯è¯´ï¼š</span><br><span class="line">**$f^*(x)$ è¡¡é‡çš„æ˜¯ï¼šæ–œç‡ä¸º $x$ çš„çº¿æ€§å‡½æ•°ï¼Œèƒ½åœ¨å¤šå¤§ç¨‹åº¦ä¸Šâ€œæ”¯æ’‘â€æˆ–â€œé€¼è¿‘â€åŸå‡½æ•° $f$ã€‚**</span><br><span class="line"></span><br><span class="line">å› æ­¤ï¼Œå‡¸å…±è½­å¯ä»¥ç†è§£ä¸º **â€œå‡½æ•°çš„æ–œç‡ç©ºé—´é‡Œçš„é‡æ–°è¡¨è¾¾â€**ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* å¦‚æœ $f(y)$ æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°ï¼Œé‚£ä¹ˆåœ¨å¹³é¢ä¸Šå¯ä»¥ç”»å¾ˆå¤šæ¡ç›´çº¿ï¼ˆä»¿å°„å‡½æ•°ï¼‰ï¼š</span><br><span class="line"></span><br><span class="line">  $$</span><br><span class="line">  \ell_x(y) = \langle x, y\rangle - b</span><br><span class="line">  $$</span><br><span class="line"></span><br><span class="line">  æƒ³è¦è®©ç›´çº¿ $\ell_x$ æ°¸è¿œåœ¨ $f(y)$ ä¸‹é¢ï¼Œ$b$ å¿…é¡»è¶³å¤Ÿå¤§ã€‚</span><br><span class="line">* é‚£ä¹ˆ $f^*(x)$ æ­£æ˜¯è¿™ä¸ªæœ€å° $b$ çš„è´Ÿæ•°ï¼Œä¹Ÿå°±æ˜¯â€œç”¨æ–œç‡ $x$ çš„ç›´çº¿æ”¯æ’‘å‡½æ•° $f$ çš„ä»£ä»·â€ã€‚</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥ **å…±è½­æ“ä½œå°±æ˜¯æŠŠå‡½æ•°æ¢ä¸€ç§åæ ‡ï¼šä»â€œç‚¹ç©ºé—´ (y)â€åˆ‡æ¢åˆ°â€œæ–œç‡ç©ºé—´ (x)â€**ã€‚</span><br><span class="line"></span><br><span class="line">ä¾‹1ï¼šäºŒæ¬¡å‡½æ•°</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">f(y) = \tfrac12\|y\|^2.</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">è®¡ç®—å…±è½­ï¼š</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">f^*(x) = \sup_y \&#123;\langle x,y\rangle - \tfrac12\|y\|^2\&#125;.</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">æœ€å¤§å€¼å‡ºç°åœ¨ $y=x$ï¼Œæ‰€ä»¥ï¼š</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">f^*(x) = \tfrac12\|x\|^2.</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">â¡ï¸ äºŒæ¬¡å‡½æ•°çš„å…±è½­è¿˜æ˜¯è‡ªå·±ã€‚</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">ä¾‹2ï¼šæŒ‡ç¤ºå‡½æ•°</span><br><span class="line"></span><br><span class="line">è‹¥</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">f(y) = \begin&#123;cases&#125;</span><br><span class="line">0 &amp; y\in C, \\</span><br><span class="line">+\infty &amp; y \notin C,</span><br><span class="line">\end&#123;cases&#125;</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">åˆ™</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">f^*(x) = \sup_&#123;y\in C&#125; \langle x,y\rangle,</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">è¿™å°±æ˜¯é›†åˆ $C$ çš„ **æ”¯æ’‘å‡½æ•°**ã€‚</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">* **åŒå…±è½­**ï¼š$f^&#123;**&#125;=f$ ï¼ˆè‹¥ $f$ æ˜¯å‡¸çš„ã€ä¸‹åŠè¿ç»­ï¼‰ã€‚è¿™å« **Fenchel-Moreau å®šç†**ã€‚</span><br><span class="line">* å…±è½­æŠŠâ€œç‚¹å€¼è§†è§’â€è½¬ä¸ºâ€œæ–œç‡è§†è§’â€ï¼Œç‰¹åˆ«é€‚åˆä¸æœ€ä¼˜ä¼ è¾“é‡Œçš„**æ¢¯åº¦æ˜ å°„**æ­é…ã€‚</span><br><span class="line">* åœ¨ OT é‡Œï¼Œæœ€ä¼˜ä¼ è¾“æ˜ å°„ $T=\nabla f^*$ï¼Œæ­£æ˜¯åˆ©ç”¨äº†â€œå‡¸å‡½æ•°çš„æ¢¯åº¦â€èƒ½ç¼–ç ä¸€ä¸ªå•å€¼æ˜ å°„çš„æ€§è´¨ã€‚</span><br><span class="line"></span><br><span class="line">**æ€»ç»“**ï¼š</span><br><span class="line">å‡¸å…±è½­ $f^*$ å°±æ˜¯æŠŠå‡½æ•° $f$ ä»â€œç‚¹ç©ºé—´â€è½¬åˆ°â€œæ–œç‡ç©ºé—´â€çš„è¡¨è¾¾ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬ç”¨æ–œç‡ä¸º $x$ çš„çº¿æ€§å‡½æ•°å»æ”¯æ’‘ $f$ çš„æœ€ä¼˜ç¨‹åº¦ã€‚å®ƒåœ¨å‡ ä½•ä¸Šå¯¹åº”æ”¯æ’‘å‡½æ•°ï¼Œåœ¨ä¼˜åŒ–ä¸ OT é‡Œæ˜¯æŠŠå‡½æ•°ä¸æ˜ å°„ï¼ˆæ¢¯åº¦ï¼‰è”ç³»èµ·æ¥çš„æ¡¥æ¢ã€‚</span><br><span class="line"></span><br><span class="line">## </span><br><span class="line">$$\begin&#123;equation&#125;</span><br><span class="line">W(\rho_c, \rho_k)=\max\limits_&#123;\substack&#123;f \in &#123;\tilde&#123;\mathrm&#123;\Phi&#125;&#125;&#125; \\ f^&#123;*&#125; \in L^&#123;1&#125;(\rho_k)&#125;&#125; \min\limits_&#123;g \in &#123;\tilde&#123;\mathrm&#123;\Phi&#125;&#125;&#125;&#125; &#123;\mathcal&#123;C&#125;&#125;_&#123;\rho_c, \rho_k&#125; \underbrace&#123;-&#123;\mathbb&#123;E&#125;&#125;_&#123;\rho_c&#125;[\langle x, \nabla g(x)\rangle-f(\nabla g(x))] - &#123;\mathbb&#123;E&#125;&#125;_&#123;\rho_k&#125;[f(y)]&#125;_&#123;&#123;\mathcal&#123;V&#125;&#125;_&#123;\rho_c, \rho_k&#125;(g, f)&#125;.</span><br><span class="line">\end&#123;equation&#125;$$</span><br><span class="line"></span><br><span class="line">å¥½çš„ï¼Œæˆ‘æ¥é€å¥å¸®ä½ ç¿»è¯‘å¹¶è§£é‡Šè¿™æ®µè¯ï¼š</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">W(\mu, \nu)= \underbrace&#123;\frac&#123;1&#125;&#123;2&#125;&#123;\mathbb&#123;E&#125;&#125;\left[\|x\|_&#123;2&#125;^&#123;2&#125;+\|y\|_&#123;2&#125;^&#123;2&#125;\right]&#125;_&#123;&#123;\mathcal&#123;C&#125;&#125;_&#123;\mu, \nu&#125;&#125;-\min _&#123;f \in &#123;\tilde&#123;\mathrm&#123;\Phi&#125;&#125;&#125;&#125; &#123;\mathbb&#123;E&#125;&#125;_&#123;\mu&#125;[f^&#123;*&#125;(x)]+&#123;\mathbb&#123;E&#125;&#125;_&#123;\nu&#125;\left[f(y)\right],</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">å…¶ä¸­ï¼š</span><br><span class="line"></span><br><span class="line">* **$\widetilde&#123;\Phi&#125;$** è¡¨ç¤ºæ‰€æœ‰å‡¸å‡½æ•°çš„é›†åˆï¼Œè¿™äº›å‡½æ•°å±äº $L^1(d\mu) \times L^1(d\nu)$ã€‚</span><br><span class="line"></span><br><span class="line">  * $L^1(\mu):=&#123;g \ \text&#123;æ˜¯å¯æµ‹å‡½æ•° ä¸”&#125; \int g , d\mu &lt; \infty &#125;$ï¼Œå³åœ¨æµ‹åº¦ $\mu$ ä¸‹å¯ç§¯çš„å‡½æ•°é›†åˆã€‚</span><br><span class="line"></span><br><span class="line">* **$f^*(x)=\max_y \langle y, x \rangle - f(y)$** æ˜¯å‡½æ•° $f$ çš„ **å‡¸å…±è½­ï¼ˆconvex conjugateï¼‰**ã€‚</span><br><span class="line"></span><br><span class="line">* å°† $\mu$ è½¬æ¢ä¸º $\nu$ çš„æœ€ä¼˜ä¼ è¾“æ˜ å°„ï¼ˆoptimal transport mapï¼‰å¯¹åº”äº $f^*$ çš„æ¢¯åº¦ï¼Œå³</span><br><span class="line"></span><br><span class="line">  $$</span><br><span class="line">  T = \nabla f^*.</span><br><span class="line">  $$</span><br><span class="line"></span><br><span class="line">* æˆ‘ä»¬å¯ä»¥æ¢å¤æœ€ä¼˜ä¼ è¾“è®¡åˆ’ï¼ˆtransport planï¼‰ï¼š</span><br><span class="line"></span><br><span class="line">  $$</span><br><span class="line">  \gamma = (\nabla f^* \times \mathrm&#123;Id&#125;)_\sharp \mu,</span><br><span class="line">  $$</span><br><span class="line"></span><br><span class="line">  å…¶ä¸­ $(\cdot)\_\sharp \mu$ è¡¨ç¤º **æ¨å‰æµ‹åº¦ï¼ˆpushforward measureï¼‰**ã€‚</span><br><span class="line"></span><br><span class="line">* Villani çš„ã€Šæœ€ä¼˜ä¼ è¾“ç†è®ºã€‹ï¼ˆTheorem 2.9ï¼‰è¯æ˜äº†ï¼šåœ¨ $\mathbb&#123;R&#125;^n$ ä¸Šï¼Œå­˜åœ¨ä¸€å¯¹æœ€ä¼˜çš„ $(f, f^*)$ï¼Œå®ƒä»¬æ˜¯ä¸‹åŠè¿ç»­ï¼ˆlower semi-continuousï¼‰ã€é€‚å½“çš„ï¼ˆproperï¼‰ä¸”äº’ä¸ºå‡¸å…±è½­å‡½æ•°ï¼Œå¹¶ä¸”å®ƒä»¬èƒ½å¤Ÿæœ€å°åŒ–ä¸Šå¼ä¸­çš„ä¼˜åŒ–é—®é¢˜ (3)ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><div class="tags"><a href="/tags/%E7%AE%97%E6%B3%95/" rel="tag"><i class="ic i-tag"></i> ç®—æ³•</a> <a href="/tags/%E7%94%9F%E7%89%A9/" rel="tag"><i class="ic i-tag"></i> ç”Ÿç‰©</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E7%B1%BB/" rel="tag"><i class="ic i-tag"></i> å­¦ä¹ ç¬”è®°ç±»</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-10-26 10:51:53" itemprop="dateModified" datetime="2025-10-26T10:51:53+08:00">2025-10-26</time> </span><span id="article/Transport/" class="item leancloud_visitors" data-flag-title="Optimal Transport" title="é˜…è¯»æ¬¡æ•°"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">é˜…è¯»æ¬¡æ•°</span> <span class="leancloud-visitors-count"></span> <span class="text">æ¬¡</span></span></div><div id="copyright"><ul><li class="author"><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>Lemon Sour <i class="ic i-at"><em>@</em></i></li><li class="link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="http://amentiraz.github.io/article/Transport/" title="Optimal Transport">http://amentiraz.github.io/article/Transport/</a></li><li class="license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC96aC1DTg=="><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/other/code-report-2025y9m19d/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;amentirazblogpic.oss-cn-hangzhou.aliyuncs.com&#x2F;blogpic&#x2F;%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240925124513.png" title="code_report_2025y9m19d"><span class="type">ä¸Šä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> å·¥ä½œæ€»ç»“</span><h3>code_report_2025y9m19d</h3></a></div><div class="item right"><a href="/article/Simple-Perform-better/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;amentirazblogpic.oss-cn-hangzhou.aliyuncs.com&#x2F;blogpic&#x2F;%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240925162929.png" title="Simple_Perform_better"><span class="type">ä¸‹ä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> è®ºæ–‡</span><h3>Simple_Perform_better</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#wasserstein"><span class="toc-number">1.</span> <span class="toc-text">Wasserstein</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kantorovich%E5%AF%B9%E5%81%B6"><span class="toc-number">2.</span> <span class="toc-text">Kantorovich å¯¹å¶</span></a></li></ol></div><div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« "><ul><li><a href="/article/scRNA%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/" rel="bookmark" title="scRNAè®ºæ–‡ç¬”è®°">scRNAè®ºæ–‡ç¬”è®°</a></li><li><a href="/article/What-is-A-Cell-Type/" rel="bookmark" title="What_is_A_Cell_Type">What_is_A_Cell_Type</a></li><li><a href="/article/Cell-Review-What-is-a-cell-type-and-how-to-define-it/" rel="bookmark" title="Cell_Review_What_is_a_cell_type_and_how_to_define_it">Cell_Review_What_is_a_cell_type_and_how_to_define_it</a></li><li><a href="/article/Benchmarking-spatial-claustering-methods-with-spatially-resolved-transcriptomic-data/" rel="bookmark" title="Benchmarking-spatial-claustering-methods-with-spatially-resolved-transcriptomic-data">Benchmarking-spatial-claustering-methods-with-spatially-resolved-transcriptomic-data</a></li><li><a href="/article/%E8%AE%BA%E6%96%87ppt1/" rel="bookmark" title="è®ºæ–‡ppt1">è®ºæ–‡ppt1</a></li><li><a href="/article/Matching-Anything-by-Segmenting-Anything/" rel="bookmark" title="Matching_Anything_by_Segmenting_Anything">Matching_Anything_by_Segmenting_Anything</a></li><li><a href="/article/SpaGCN/" rel="bookmark" title="SpaGCN">SpaGCN</a></li><li><a href="/article/STAGATE/" rel="bookmark" title="STAGATE">STAGATE</a></li><li><a href="/article/MENDER/" rel="bookmark" title="MENDER">MENDER</a></li><li><a href="/article/scanpy%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/" rel="bookmark" title="scanpyæ•°æ®ä½¿ç”¨ç¬”è®°">scanpyæ•°æ®ä½¿ç”¨ç¬”è®°</a></li><li><a href="/article/BayesSpace/" rel="bookmark" title="BayesSpace">BayesSpace</a></li><li><a href="/article/%E6%95%B0%E6%8D%AE%E9%9B%86%E8%AE%B0%E5%BD%95/" rel="bookmark" title="æ•°æ®é›†è®°å½•">æ•°æ®é›†è®°å½•</a></li><li><a href="/article/DeepST/" rel="bookmark" title="DeepST">DeepST</a></li><li><a href="/article/EnSDD/" rel="bookmark" title="EnSDD">EnSDD</a></li><li><a href="/article/domain%E5%86%85%E5%AE%B9%E7%9A%84%E6%80%BB%E7%BB%93/" rel="bookmark" title="å¯¹spatial domainå†…å®¹çš„æ€»ç»“">å¯¹spatial domainå†…å®¹çš„æ€»ç»“</a></li><li><a href="/article/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3%E6%B1%87%E6%80%BB/" rel="bookmark" title="æ¯•ä¸šè®¾è®¡æ–‡æ¡£æ±‡æ€»">æ¯•ä¸šè®¾è®¡æ–‡æ¡£æ±‡æ€»</a></li><li><a href="/article/scPerturb/" rel="bookmark" title="scPerturb">scPerturb</a></li><li><a href="/article/GEARS/" rel="bookmark" title="GEARS">GEARS</a></li><li><a href="/article/CellOT/" rel="bookmark" title="CellOT">CellOT</a></li><li class="active"><a href="/article/Transport/" rel="bookmark" title="Optimal Transport">Optimal Transport</a></li><li><a href="/article/Simple-Perform-better/" rel="bookmark" title="Simple_Perform_better">Simple_Perform_better</a></li><li><a href="/article/Systema/" rel="bookmark" title="Systema">Systema</a></li><li><a href="/article/Virtual-Challenge/" rel="bookmark" title="Virtual_Challenge">Virtual_Challenge</a></li><li><a href="/article/scGPT/" rel="bookmark" title="scGPT">scGPT</a></li><li><a href="/article/scFoundation/" rel="bookmark" title="scFoundation">scFoundation</a></li><li><a href="/article/GeneFormer/" rel="bookmark" title="GeneFormer">GeneFormer</a></li><li><a href="/article/CellFM/" rel="bookmark" title="CellFM">CellFM</a></li></ul></div><div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Lemon Sour" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Lemon Sour</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">101</span> <span class="name">æ–‡ç« </span></a></div><div class="item categories"><a href="/categories/"><span class="count">26</span> <span class="name">åˆ†ç±»</span></a></div><div class="item tags"><a href="/tags/"><span class="count">63</span> <span class="name">æ ‡ç­¾</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0FtZW50aXJheg==" title="https:&#x2F;&#x2F;github.com&#x2F;Amentiraz"><i class="ic i-github"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9kc2ZseS04" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;dsfly-8"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTE1MTc2ODUzMzM=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;1517685333"><i class="ic i-cloud-music"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnZpb2xlbW9uQDE2My5jb20=" title="mailto:violemon@163.com"><i class="ic i-envelope"></i></span> <span class="exturl item bangumi" data-url="aHR0cHM6Ly9iYW5ndW1pLnR2L2FuaW1lL2xpc3QvNjY4MDE2" title="https:&#x2F;&#x2F;bangumi.tv&#x2F;anime&#x2F;list&#x2F;668016"><i class="ic i-bilibili"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-magic"></i>å…³äº</a><ul class="submenu"><li class="item"><a href="/author/" rel="section"><i class="ic i-user"></i>æœ¬äºº</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>æ–‡ç« </a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-cloud"></i>å…¶å®ƒ</a><ul class="submenu"><li class="item"><a href="/music/" rel="section"><i class="ic i-music"></i>éŸ³ä¹åŒº</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>æœ‹å‹</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/other/code-report-2025y9m19d/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/article/Simple-Perform-better/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>éšæœºæ–‡ç« </h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/article/" title="åˆ†ç±»äº è®ºæ–‡">è®ºæ–‡</a></div><span><a href="/article/Cell-Review-What-is-a-cell-type-and-how-to-define-it/" title="Cell_Review_What_is_a_cell_type_and_how_to_define_it">Cell_Review_What_is_a_cell_type_and_how_to_define_it</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/code/" title="åˆ†ç±»äº ä»£ç ">ä»£ç </a> <i class="ic i-angle-right"></i> <a href="/categories/code/OI/" title="åˆ†ç±»äº OI">OI</a></div><span><a href="/code/DP/" title="DP">DP</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/note/" title="åˆ†ç±»äº å½±è§†ä¹¦ç±">å½±è§†ä¹¦ç±</a> <i class="ic i-angle-right"></i> <a href="/categories/note/%E5%8A%A8%E6%BC%AB/" title="åˆ†ç±»äº åŠ¨æ¼«">åŠ¨æ¼«</a></div><span><a href="/life/English-Anime/" title="English_Anime">English_Anime</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/life/" title="åˆ†ç±»äº ç”Ÿæ´»">ç”Ÿæ´»</a> <i class="ic i-angle-right"></i> <a href="/categories/life/%E6%BC%94%E5%A5%8F%E4%BC%9A/" title="åˆ†ç±»äº æ¼”å¥ä¼š">æ¼”å¥ä¼š</a></div><span><a href="/life/kanekoayano/" title="kanekoayano">kanekoayano</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/note/" title="åˆ†ç±»äº å½±è§†ä¹¦ç±">å½±è§†ä¹¦ç±</a> <i class="ic i-angle-right"></i> <a href="/categories/note/%E5%8A%A8%E6%BC%AB/" title="åˆ†ç±»äº åŠ¨æ¼«">åŠ¨æ¼«</a></div><span><a href="/note/%E6%94%BB%E5%A3%B3%E6%9C%BA%E5%8A%A8%E9%98%9FSAC/" title="æ”»å£³æœºåŠ¨é˜ŸSAC">æ”»å£³æœºåŠ¨é˜ŸSAC</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/article/" title="åˆ†ç±»äº è®ºæ–‡">è®ºæ–‡</a></div><span><a href="/article/scGPT/" title="scGPT">scGPT</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/article/" title="åˆ†ç±»äº è®ºæ–‡">è®ºæ–‡</a></div><span><a href="/article/domain%E5%86%85%E5%AE%B9%E7%9A%84%E6%80%BB%E7%BB%93/" title="å¯¹spatial domainå†…å®¹çš„æ€»ç»“">å¯¹spatial domainå†…å®¹çš„æ€»ç»“</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/music/" title="åˆ†ç±»äº éŸ³ä¹">éŸ³ä¹</a> <i class="ic i-angle-right"></i> <a href="/categories/music/%E4%B9%90%E7%90%86/" title="åˆ†ç±»äº ä¹ç†">ä¹ç†</a></div><span><a href="/music/%E5%B8%B8%E8%A7%81%E5%92%8C%E5%BC%A6/" title="å¸¸è§å’Œå¼¦">å¸¸è§å’Œå¼¦</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/other/" title="åˆ†ç±»äº å…¶å®ƒ">å…¶å®ƒ</a> <i class="ic i-angle-right"></i> <a href="/categories/other/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/" title="åˆ†ç±»äº å·¥ä½œæ€»ç»“">å·¥ä½œæ€»ç»“</a></div><span><a href="/other/report-2025y10m23d/" title="report_2025y10m23d">report_2025y10m23d</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/code/" title="åˆ†ç±»äº ä»£ç ">ä»£ç </a> <i class="ic i-angle-right"></i> <a href="/categories/code/OI/" title="åˆ†ç±»äº OI">OI</a></div><span><a href="/code/Dijkstra/" title="Dijkstra">Dijkstra</a></span></li></ul></div><div><h2>æœ€æ–°è¯„è®º</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 â€“ <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Lemon Sour @ Amentiraz</span></div><div class="powered-by">åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"article/Transport/",favicon:{show:"â½â½à¬˜( ËŠáµ•Ë‹ )à¬“â¾â¾",hide:"(ã¤Ğ´âŠ‚)"},search:{placeholder:"æ–‡ç« æœç´¢",empty:"å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",stats:"${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->